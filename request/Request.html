        <!DOCTYPE html>
        <html>
        <head>
                <meta charset="utf-8">
        <title>Request class / request Library / Dart Documentation</title>
        <link rel="stylesheet" type="text/css"
            href="../styles.css">
        <link href="//fonts.googleapis.com/css?family=Open+Sans:400,600,700,800" rel="stylesheet" type="text/css">
        <link rel="shortcut icon" href="../favicon.ico">
        
        </head>
        <body data-library="request" data-type="Request">
        <div class="page">
        <div class="header">
          <a href="../index.html"><div class="logo"></div></a>
          <a href="../index.html">Dart Documentation</a>
         &rsaquo; <a href="../request.html">request</a> &rsaquo; <a href="../request/Request.html">Request</a>        <div id="search-box">
          <input type="search" name="q" id="q" autocomplete="off"
              class="search-input" placeholder="Search API">
        </div>
        
      </div>
      <div class="drop-down" id="drop-down"></div>
      
        <div class="nav">
        
</div>
<div class="content">
        <h2><strong>Request</strong>
          class
        </h2>
        
<button id="show-inherited" class="show-inherited">Hide inherited</button>
<div class="doc">
<p>An HTTP request where the entire request body is known in advance.</p>
<pre class="source">
class Request extends BaseRequest {
 /// The size of the request body, in bytes. This is calculated from
 /// [bodyBytes].
 ///
 /// The content length cannot be set for [Request], since it's automatically
 /// calculated from [bodyBytes].
 int get contentLength =&gt; bodyBytes.length;

 set contentLength(int value) {
   throw new UnsupportedError("Cannot set the contentLength property of "
       "non-streaming Request objects.");
 }

 /// The default encoding to use when converting between [bodyBytes] and
 /// [body]. This is only used if [encoding] hasn't been manually set and if
 /// the content-type header has no encoding information.
 Encoding _defaultEncoding;

 /// The encoding used for the request. This encoding is used when converting
 /// between [bodyBytes] and [body].
 ///
 /// If the request has a `Content-Type` header and that header has a `charset`
 /// parameter, that parameter's value is used as the encoding. Otherwise, if
 /// [encoding] has been set manually, that encoding is used. If that hasn't
 /// been set either, this defaults to [Encoding.UTF_8].
 ///
 /// If the `charset` parameter's value is not a known [Encoding], reading this
 /// will throw a [FormatException].
 ///
 /// If the request has a `Content-Type` header, setting this will set the
 /// charset parameter on that header.
 Encoding get encoding {
   if (_contentType == null || _contentType.charset == null) {
     return _defaultEncoding;
   }
   return requiredEncodingForCharset(_contentType.charset);
 }

 set encoding(Encoding value) {
   _checkFinalized();
   _defaultEncoding = value;
   var contentType = _contentType;
   if (contentType != null) {
     contentType = new ContentType(contentType.primaryType,
                                   contentType.subType,
                                   charset: value.name,
                                   parameters: contentType.parameters);
     _contentType = contentType;
   }
 }

 // TODO(nweiz): make this return a read-only view
 /// The bytes comprising the body of the request. This is converted to and
 /// from [body] using [encoding].
 ///
 /// This list should only be set, not be modified in place.
 Uint8List get bodyBytes =&gt; _bodyBytes;
 Uint8List _bodyBytes;

 set bodyBytes(List&lt;int&gt; value) {
   _checkFinalized();
   _bodyBytes = toUint8List(value);
 }

 /// The body of the request as a string. This is converted to and from
 /// [bodyBytes] using [encoding].
 ///
 /// When this is set, if the request does not yet have a `Content-Type`
 /// header, one will be added with the type `text/plain`. Then the `charset`
 /// parameter of the `Content-Type` header (whether new or pre-existing) will
 /// be set to [encoding] if it wasn't already set.
 String get body =&gt; decodeString(bodyBytes, encoding);

 set body(String value) {
   bodyBytes = encodeString(value, encoding);
   var contentType = _contentType;
   if (contentType == null) {
     contentType = new ContentType("text", "plain", charset: encoding.name);
   } else if (contentType.charset == null) {
     contentType = new ContentType(contentType.primaryType,
                                   contentType.subType,
                                   charset: encoding.name,
                                   parameters: contentType.parameters);
   }
   _contentType = contentType;
 }

 /// The form-encoded fields in the body of the request as a map from field
 /// names to values. The form-encoded body is converted to and from
 /// [bodyBytes] using [encoding] (in the same way as [body]).
 ///
 /// If the request doesn't have a `Content-Type` header of
 /// `application/x-www-form-urlencoded`, reading this will throw a
 /// [StateError].
 ///
 /// If the request has a `Content-Type` header with a type other than
 /// `application/x-www-form-urlencoded`, setting this will throw a
 /// [StateError]. Otherwise, the content type will be set to
 /// `application/x-www-form-urlencoded`.
 ///
 /// This map should only be set, not modified in place.
 Map&lt;String, String&gt; get bodyFields {
   if (_contentType == null ||
       _contentType.value != "application/x-www-form-urlencoded") {
     throw new StateError('Cannot access the body fields of a Request without '
         'content-type "application/x-www-form-urlencoded".');
   }

   return queryToMap(body);
 }

 set bodyFields(Map&lt;String, String&gt; fields) {
   if (_contentType == null) {
     _contentType = new ContentType("application", "x-www-form-urlencoded");
   } else if (_contentType.value != "application/x-www-form-urlencoded") {
     throw new StateError('Cannot set the body fields of a Request with '
         'content-type "${_contentType.value}".');
   }

   this.body = mapToQuery(fields);
 }

 /// Creates a new HTTP request.
 Request(String method, Uri url)
   : super(method, url),
     _defaultEncoding = Encoding.UTF_8,
     _bodyBytes = new Uint8List(0);

 /// Freezes all mutable fields and returns a single-subscription [ByteStream]
 /// containing the request body.
 ByteStream finalize() {
   super.finalize();
   return new ByteStream.fromBytes(bodyBytes);
 }

 /// The `Content-Type` header of the request (if it exists) as a
 /// [ContentType].
 ContentType get _contentType {
   var contentType = headers[HttpHeaders.CONTENT_TYPE];
   if (contentType == null) return null;
   return new ContentType.fromString(contentType);
 }

 set _contentType(ContentType value) {
   headers[HttpHeaders.CONTENT_TYPE] = value.toString();
 }

 /// Throw an error if this request has been finalized.
 void _checkFinalized() {
   if (!finalized) return;
   throw new StateError("Can't modify a finalized Request.");
 }
}
</pre>
</div>
<h3>Extends</h3>
<p>
<span class="type-box"><span class="icon-class"></span><a href="../base_request/BaseRequest.html">BaseRequest</a></span>&nbsp;&gt;&nbsp;<span class="type-box"><span class="icon-class"></span><strong>Request</strong></span></p>
<div>
<h3>Constructors</h3>
<div class="method"><h4 id="Request">
<button class="show-code">Code</button>
new <strong>Request</strong>(<a href="http://api.dartlang.org/dart_core/String.html">String</a> method, <a href="http://api.dartlang.org/dart_uri/Uri.html">Uri</a> url) <a class="anchor-link" href="#Request"
              title="Permalink to Request.Request">#</a></h4>
<div class="doc">
<p>Creates a new HTTP request.</p>
<pre class="source">
Request(String method, Uri url)
 : super(method, url),
   _defaultEncoding = Encoding.UTF_8,
   _bodyBytes = new Uint8List(0);
</pre>
</div>
</div>
</div>
<div>
<h3>Properties</h3>
<div class="field"><h4 id="body">
<button class="show-code">Code</button>
<a href="http://api.dartlang.org/dart_core/String.html">String</a>         <strong>body</strong> <a class="anchor-link"
            href="#body"
            title="Permalink to Request.body">#</a>
        </h4>
        <div class="doc">
<p>The body of the request as a string. This is converted to and from
<a class="crossref" href="../request/Request.html#bodyBytes">bodyBytes</a> using <a class="crossref" href="../request/Request.html#encoding">encoding</a>.</p>
<p>When this is set, if the request does not yet have a <code>Content-Type</code>
header, one will be added with the type <code>text/plain</code>. Then the <code>charset</code>
parameter of the <code>Content-Type</code> header (whether new or pre-existing) will
be set to <a class="crossref" href="../request/Request.html#encoding">encoding</a> if it wasn't already set.</p>
<pre class="source">
String get body =&gt; decodeString(bodyBytes, encoding);
</pre>
<pre class="source">
set body(String value) {
 bodyBytes = encodeString(value, encoding);
 var contentType = _contentType;
 if (contentType == null) {
   contentType = new ContentType("text", "plain", charset: encoding.name);
 } else if (contentType.charset == null) {
   contentType = new ContentType(contentType.primaryType,
                                 contentType.subType,
                                 charset: encoding.name,
                                 parameters: contentType.parameters);
 }
 _contentType = contentType;
}
</pre>
</div>
</div>
<div class="field"><h4 id="bodyBytes">
<button class="show-code">Code</button>
<a href="http://api.dartlang.org/dart_typed_data/Uint8List.html">Uint8List</a>         <strong>bodyBytes</strong> <a class="anchor-link"
            href="#bodyBytes"
            title="Permalink to Request.bodyBytes">#</a>
        </h4>
        <div class="doc">
<p>The bytes comprising the body of the request. This is converted to and
from <a class="crossref" href="../request/Request.html#body">body</a> using <a class="crossref" href="../request/Request.html#encoding">encoding</a>.</p>
<p>This list should only be set, not be modified in place.</p>
<pre class="source">
Uint8List get bodyBytes =&gt; _bodyBytes;
</pre>
<pre class="source">
set bodyBytes(List&lt;int&gt; value) {
 _checkFinalized();
 _bodyBytes = toUint8List(value);
}
</pre>
</div>
</div>
<div class="field"><h4 id="bodyFields">
<button class="show-code">Code</button>
<a href="http://api.dartlang.org/dart_core/Map.html">Map</a>&lt;<a href="http://api.dartlang.org/dart_core/String.html">String</a>, <a href="http://api.dartlang.org/dart_core/String.html">String</a>&gt;         <strong>bodyFields</strong> <a class="anchor-link"
            href="#bodyFields"
            title="Permalink to Request.bodyFields">#</a>
        </h4>
        <div class="doc">
<p>The form-encoded fields in the body of the request as a map from field
names to values. The form-encoded body is converted to and from
<a class="crossref" href="../request/Request.html#bodyBytes">bodyBytes</a> using <a class="crossref" href="../request/Request.html#encoding">encoding</a> (in the same way as <a class="crossref" href="../request/Request.html#body">body</a>).</p>
<p>If the request doesn't have a <code>Content-Type</code> header of
<code>application/x-www-form-urlencoded</code>, reading this will throw a
<code>StateError</code>.</p>
<p>If the request has a <code>Content-Type</code> header with a type other than
<code>application/x-www-form-urlencoded</code>, setting this will throw a
<code>StateError</code>. Otherwise, the content type will be set to
<code>application/x-www-form-urlencoded</code>.</p>
<p>This map should only be set, not modified in place.</p>
<pre class="source">
Map&lt;String, String&gt; get bodyFields {
 if (_contentType == null ||
     _contentType.value != "application/x-www-form-urlencoded") {
   throw new StateError('Cannot access the body fields of a Request without '
       'content-type "application/x-www-form-urlencoded".');
 }

 return queryToMap(body);
}
</pre>
<pre class="source">
set bodyFields(Map&lt;String, String&gt; fields) {
 if (_contentType == null) {
   _contentType = new ContentType("application", "x-www-form-urlencoded");
 } else if (_contentType.value != "application/x-www-form-urlencoded") {
   throw new StateError('Cannot set the body fields of a Request with '
       'content-type "${_contentType.value}".');
 }

 this.body = mapToQuery(fields);
}
</pre>
</div>
</div>
<div class="field"><h4 id="contentLength">
<button class="show-code">Code</button>
<a href="http://api.dartlang.org/dart_core/int.html">int</a>         <strong>contentLength</strong> <a class="anchor-link"
            href="#contentLength"
            title="Permalink to Request.contentLength">#</a>
        </h4>
        <div class="doc">
<p>The size of the request body, in bytes. This is calculated from
<a class="crossref" href="../request/Request.html#bodyBytes">bodyBytes</a>.</p>
<p>The content length cannot be set for <a class="crossref" href="../request/Request.html#Request">Request</a>, since it's automatically
calculated from <a class="crossref" href="../request/Request.html#bodyBytes">bodyBytes</a>.</p>
<pre class="source">
int get contentLength =&gt; bodyBytes.length;
</pre>
<pre class="source">
set contentLength(int value) {
 throw new UnsupportedError("Cannot set the contentLength property of "
     "non-streaming Request objects.");
}
</pre>
</div>
</div>
<div class="field"><h4 id="encoding">
<button class="show-code">Code</button>
<a href="http://api.dartlang.org/dart_io/Encoding.html">Encoding</a>         <strong>encoding</strong> <a class="anchor-link"
            href="#encoding"
            title="Permalink to Request.encoding">#</a>
        </h4>
        <div class="doc">
<p>The encoding used for the request. This encoding is used when converting
between <a class="crossref" href="../request/Request.html#bodyBytes">bodyBytes</a> and <a class="crossref" href="../request/Request.html#body">body</a>.</p>
<p>If the request has a <code>Content-Type</code> header and that header has a <code>charset</code>
parameter, that parameter's value is used as the encoding. Otherwise, if
<a class="crossref" href="../request/Request.html#encoding">encoding</a> has been set manually, that encoding is used. If that hasn't
been set either, this defaults to <code>Encoding.UTF_8</code>.</p>
<p>If the <code>charset</code> parameter's value is not a known <code>Encoding</code>, reading this
will throw a <code>FormatException</code>.</p>
<p>If the request has a <code>Content-Type</code> header, setting this will set the
charset parameter on that header.</p>
<pre class="source">
Encoding get encoding {
 if (_contentType == null || _contentType.charset == null) {
   return _defaultEncoding;
 }
 return requiredEncodingForCharset(_contentType.charset);
}
</pre>
<pre class="source">
set encoding(Encoding value) {
 _checkFinalized();
 _defaultEncoding = value;
 var contentType = _contentType;
 if (contentType != null) {
   contentType = new ContentType(contentType.primaryType,
                                 contentType.subType,
                                 charset: value.name,
                                 parameters: contentType.parameters);
   _contentType = contentType;
 }
}
</pre>
</div>
</div>
<div class="field inherited"><h4 id="finalized">
<button class="show-code">Code</button>
final <a href="http://api.dartlang.org/dart_core/bool.html">bool</a>         <strong>finalized</strong> <a class="anchor-link"
            href="#finalized"
            title="Permalink to Request.finalized">#</a>
        </h4>
        <div class="inherited-from">inherited from <a href="../base_request/BaseRequest.html">BaseRequest</a> </div><div class="doc">
<p>Whether the request has been finalized.</p>
<pre class="source">
bool get finalized =&gt; _finalized;
</pre>
</div>
</div>
<div class="field inherited"><h4 id="followRedirects">
<button class="show-code">Code</button>
<a href="http://api.dartlang.org/dart_core/bool.html">bool</a>         <strong>followRedirects</strong> <a class="anchor-link"
            href="#followRedirects"
            title="Permalink to Request.followRedirects">#</a>
        </h4>
        <div class="inherited-from">inherited from <a href="../base_request/BaseRequest.html">BaseRequest</a> </div><div class="doc">
<p>Whether the client should follow redirects while resolving this request.
Defaults to true.</p>
<pre class="source">
bool get followRedirects =&gt; _followRedirects;
</pre>
<pre class="source">
set followRedirects(bool value) {
 _checkFinalized();
 _followRedirects = value;
}
</pre>
</div>
</div>
<div class="field inherited"><h4 id="headers">
<button class="show-code">Code</button>
final <a href="http://api.dartlang.org/dart_core/Map.html">Map</a>&lt;<a href="http://api.dartlang.org/dart_core/String.html">String</a>, <a href="http://api.dartlang.org/dart_core/String.html">String</a>&gt;         <strong>headers</strong> <a class="anchor-link"
            href="#headers"
            title="Permalink to Request.headers">#</a>
        </h4>
        <div class="inherited-from">inherited from <a href="../base_request/BaseRequest.html">BaseRequest</a> </div><div class="doc">
<p>The headers for this request.</p>
<pre class="source">
final Map&lt;String, String&gt; headers
</pre>
</div>
</div>
<div class="field inherited"><h4 id="maxRedirects">
<button class="show-code">Code</button>
<a href="http://api.dartlang.org/dart_core/int.html">int</a>         <strong>maxRedirects</strong> <a class="anchor-link"
            href="#maxRedirects"
            title="Permalink to Request.maxRedirects">#</a>
        </h4>
        <div class="inherited-from">inherited from <a href="../base_request/BaseRequest.html">BaseRequest</a> </div><div class="doc">
<p>The maximum number of redirects to follow when <code>followRedirects</code> is true.
If this number is exceeded the <code>BaseResponse</code> future will signal a
<code>RedirectLimitExceeded</code> exception. Defaults to 5.</p>
<pre class="source">
int get maxRedirects =&gt; _maxRedirects;
</pre>
<pre class="source">
set maxRedirects(int value) {
 _checkFinalized();
 _maxRedirects = value;
}
</pre>
</div>
</div>
<div class="field inherited"><h4 id="method">
<button class="show-code">Code</button>
final <a href="http://api.dartlang.org/dart_core/String.html">String</a>         <strong>method</strong> <a class="anchor-link"
            href="#method"
            title="Permalink to Request.method">#</a>
        </h4>
        <div class="inherited-from">inherited from <a href="../base_request/BaseRequest.html">BaseRequest</a> </div><div class="doc">
<p>The HTTP method of the request. Most commonly "GET" or "POST", less
commonly "HEAD", "PUT", or "DELETE". Non-standard method names are also
supported.</p>
<pre class="source">
final String method
</pre>
</div>
</div>
<div class="field inherited"><h4 id="persistentConnection">
<button class="show-code">Code</button>
<a href="http://api.dartlang.org/dart_core/bool.html">bool</a>         <strong>persistentConnection</strong> <a class="anchor-link"
            href="#persistentConnection"
            title="Permalink to Request.persistentConnection">#</a>
        </h4>
        <div class="inherited-from">inherited from <a href="../base_request/BaseRequest.html">BaseRequest</a> </div><div class="doc">
<p>Whether a persistent connection should be maintained with the server.
Defaults to true.</p>
<pre class="source">
bool get persistentConnection =&gt; _persistentConnection;
</pre>
<pre class="source">
set persistentConnection(bool value) {
 _checkFinalized();
 _persistentConnection = value;
}
</pre>
</div>
</div>
<div class="field inherited"><h4 id="url">
<button class="show-code">Code</button>
final <a href="http://api.dartlang.org/dart_uri/Uri.html">Uri</a>         <strong>url</strong> <a class="anchor-link"
            href="#url"
            title="Permalink to Request.url">#</a>
        </h4>
        <div class="inherited-from">inherited from <a href="../base_request/BaseRequest.html">BaseRequest</a> </div><div class="doc">
<p>The URL to which the request will be sent.</p>
<pre class="source">
final Uri url
</pre>
</div>
</div>
</div>
<div>
<h3>Methods</h3>
<div class="method"><h4 id="finalize">
<button class="show-code">Code</button>
<a href="../byte_stream/ByteStream.html">ByteStream</a> <strong>finalize</strong>() <a class="anchor-link" href="#finalize"
              title="Permalink to Request.finalize">#</a></h4>
<div class="doc">
<p>Freezes all mutable fields and returns a single-subscription <code>ByteStream</code>
containing the request body.</p>
<pre class="source">
ByteStream finalize() {
 super.finalize();
 return new ByteStream.fromBytes(bodyBytes);
}
</pre>
</div>
</div>
<div class="method inherited"><h4 id="send">
<button class="show-code">Code</button>
<a href="http://api.dartlang.org/dart_async/Future.html">Future</a>&lt;<a href="../streamed_response/StreamedResponse.html">StreamedResponse</a>&gt; <strong>send</strong>() <a class="anchor-link" href="#send"
              title="Permalink to Request.send">#</a></h4>
<div class="inherited-from">inherited from <a href="../base_request/BaseRequest.html">BaseRequest</a> </div><div class="doc">
<p>Sends this request.</p>
<p>This automatically initializes a new <code>Client</code> and closes that client once
the request is complete. If you're planning on making multiple requests to
the same server, you should use a single <code>Client</code> for all of those
requests.</p>
<pre class="source">
Future&lt;StreamedResponse&gt; send() {
 var client = new Client();
 return client.send(this).then((response) {
   var stream = onDone(response.stream, client.close);
   return new StreamedResponse(
       new ByteStream(stream),
       response.statusCode,
       response.contentLength,
       request: response.request,
       headers: response.headers,
       isRedirect: response.isRedirect,
       persistentConnection: response.persistentConnection,
       reasonPhrase: response.reasonPhrase);
 }).catchError((e) {
   client.close();
   throw e;
 });
}
</pre>
</div>
</div>
<div class="method inherited"><h4 id="toString">
<button class="show-code">Code</button>
<a href="http://api.dartlang.org/dart_core/String.html">String</a> <strong>toString</strong>() <a class="anchor-link" href="#toString"
              title="Permalink to Request.toString">#</a></h4>
<div class="inherited-from">inherited from <a href="../base_request/BaseRequest.html">BaseRequest</a> </div><div class="doc">
<div class="inherited">
<p>Returns a string representation of this object.</p>
<div class="docs-inherited-from">docs inherited from <a href="http://api.dartlang.org/dart_core/Object.html">Object</a> </div></div>
<pre class="source">
String toString() =&gt; "$method $url";
</pre>
</div>
</div>
</div>
        </div>
        <div class="clear"></div>
        </div>
        <div class="footer">
          
        </div>
        <script async src="../client-live-nav.js"></script>
        </body></html>
        
